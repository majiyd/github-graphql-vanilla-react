(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,r){e.exports={app:"App_app__26vqA",input:"App_input__3L_gL"}},11:function(e,t,r){e.exports={star:"Star_star__P1cBw"}},12:function(e,t,r){e.exports={repositories:"Repositories_repositories__1dhs-",repos:"Repositories_repos__2pLKs"}},13:function(e,t,r){e.exports={primary:"Button_primary__r89pR"}},24:function(e,t,r){e.exports={login:"Login_login__kdPEu"}},26:function(e,t,r){e.exports=r(50)},32:function(e,t,r){},50:function(e,t,r){"use strict";r.r(t);var n=r(3),a=r(4),o=r(6),i=r(5),s=r(7),c=r(0),u=r.n(c),l=r(23),p=r.n(l),h=(r(32),r(2)),d=r(25),m=r(8),b=r(9),g=r.n(b),f=r(10),y=r.n(f),v=r(12),x=r.n(v),E=r(13),S=r.n(E);function w(e){switch(e.isDisabled){case!0:return u.a.createElement("button",{type:e.type,className:S.a.primary,onClick:e.handleClick,disabled:!0},e.text);default:return u.a.createElement("button",{type:e.type,className:S.a.primary,onClick:e.handleClick},e.text)}}var F=r(11),k=r.n(F);function R(e){switch(e.viewerHasStarred){case!0:return u.a.createElement("span",{className:k.a.star,onClick:function(){return e.unStarRepository(e.id)}},u.a.createElement("abbr",{title:"Unstar Repository"},"\u2605"));case!1:default:return u.a.createElement("span",{className:k.a.star,onClick:function(){return e.starRepository(e.id)}},u.a.createElement("abbr",{title:"Star Repository"},"\u2606"))}}function T(e){return u.a.createElement("div",{className:x.a.repositories},u.a.createElement("h1",null,"Repositories"),u.a.createElement("div",null,void 0===e.repositories||0===e.repositories.length||e.errors?u.a.createElement("h2",{style:{textAlign:"center"}},"No Information Available"):u.a.createElement(u.a.Fragment,null,u.a.createElement("a",{href:e.url},"See On Github"),u.a.createElement("ul",{className:x.a.repos},e.repositories.edges.map(function(t){return u.a.createElement("li",{key:t.node.id},u.a.createElement(R,{viewerHasStarred:t.node.viewerHasStarred,id:t.node.id,starRepository:e.starRepository,unStarRepository:e.unStarRepository}),t.node.name," ",u.a.createElement("a",{href:t.node.url},t.node.url))})),e.repositories.pageInfo.hasPreviousPage?u.a.createElement(w,{text:"Prev",handleClick:e.onFetchPreviousRepositories}):u.a.createElement(w,{text:"Prev",isDisabled:!0}),e.repositories.pageInfo.hasNextPage?u.a.createElement(w,{text:"Next",handleClick:e.onFetchMoreRepositories}):u.a.createElement(w,{text:"Next",isDisabled:!0}))))}var j=u.a.createContext({}),C=j.Provider,O=(j.Consumer,r(24)),_=r.n(O),I=function(e){function t(){return Object(n.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=window.location.href.match(/\?code=(.*)/)&&window.location.href.match(/\?code=(.*)/)[1];t&&(this.context.setFetchingToTrue(),fetch("https://simple-github-graphql-client.herokuapp.com/authenticate/".concat(t)).then(function(e){return e.json()}).then(function(t){var r=t.token;e.context.unSetFetchingToFalse(),r?e.context.setToken(1):e.context.setToken(0),window.token=r}))}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:_.a.login},u.a.createElement("h1",null," Github Client"),u.a.createElement("div",{style:{marginBottom:"12%"}},u.a.createElement("p",null,"This is a simple app built by ",u.a.createElement("a",{href:"https://github.com/majiyd"},"majiyd"),". It is based on chapter 3 of Robin Wieruch's ",u.a.createElement("a",{href:"https://www.robinwieruch.de/graphql-tutorial/"},"graphQL  tutorial"),"."),u.a.createElement("p",null,"In this app, you can search for github users, star or unstar their repositories")),u.a.createElement("a",{href:"https://github.com/login/oauth/authorize?client_id=".concat("ae2ae2dbb55737a71a4c","&scope=user,repo&redirect_uri=").concat("http://localhost:3000/"),onClick:function(){e.context.setFetchingToTrue()},style:{backgroundColor:"#E10098",color:"white",padding:" 2% 3%",margin:"0 1%",borderRadius:"3px"}},"Signin with Github"))}}]),t}(u.a.Component);I.contextType=j,I.contextType=j;var N=I,P="\n  query (\n    $user: String!,\n    $cursor: String\n  ){\n    user(login: $user){\n      name\n      url\n      repositories(first:5 after: $cursor ){\n        edges{\n          node{\n            name\n            url\n            id\n            viewerHasStarred\n          }\n        }\n        totalCount\n        pageInfo{\n          endCursor\n          hasNextPage\n          hasPreviousPage\n        }\n      }\n    }\n  }\n",q="\n  mutation ($repositoryId: ID!){\n    addStar(input:{starrableId: $repositoryId}){\n      starrable{\n        viewerHasStarred\n      }\n    }\n  }\n",A="\n  mutation ($repositoryId: ID!) {\n    removeStar(input: { starrableId: $repositoryId }) {\n      starrable {\n        viewerHasStarred\n      }\n    }\n  }\n",G=function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(o.a)(this,Object(i.a)(t).call(this,e))).onChange=function(e){r.setState({user:e.target.value})},r.onSubmit=function(e){r.setState({searchingUser:r.state.user,cursors:[]}),r.fetchFromGithub(r.state.user),e.preventDefault()},r.fetchMoreRepositories=function(){var e=r.state.repositories.pageInfo.endCursor;r.fetchFromGithub(r.state.searchingUser,e)},r.fetchFromGithub=function(e,t){r.context.setFetchingToTrue(),g.a.post("https://api.github.com/graphql",{query:P,variables:{user:e,cursor:t}},{headers:{Authorization:"bearer ".concat(window.token)}}).then(function(e){r.setState({url:e.data.data.user.url,repositories:e.data.data.user.repositories,errors:null,cursors:[].concat(Object(d.a)(r.state.cursors),[e.data.data.user.repositories.pageInfo.endCursor])}),r.context.unSetFetchingToFalse()}).catch(function(e){r.setState({errors:e}),r.context.unSetFetchingToFalse()})},r.fetchPreviousRepositories=function(){r.context.setFetchingToTrue();var e=r.state.cursors.slice(0,-2);r.setState({cursors:e});var t=r.state.searchingUser,n=e.slice(-1)[0];r.fetchFromGithub(t,n)},r.starRepository=function(e){return r.context.setFetchingToTrue(),g.a.post("https://api.github.com/graphql",{query:q,variables:{repositoryId:e}},{headers:{Authorization:"bearer ".concat(window.token)}}).then(function(t){r.context.unSetFetchingToFalse();var n=r.state.repositories.edges.map(function(t){return t.node.id===e?Object(h.a)({},t,{node:Object(h.a)({},t.node,{viewerHasStarred:!0})}):t});return r.setState({repositories:Object(h.a)({},r.state.repositories,{edges:n})})}).catch(function(e){r.setState({errors:e}),r.context.unSetFetchingToFalse()})},r.unStarRepository=function(e){return r.context.setFetchingToTrue(),g.a.post("https://api.github.com/graphql",{query:A,variables:{repositoryId:e}},{headers:{Authorization:"bearer ".concat(window.token)}}).then(function(t){r.context.unSetFetchingToFalse();var n=r.state.repositories.edges.map(function(t){return t.node.id===e?Object(h.a)({},t,{node:Object(h.a)({},t.node,{viewerHasStarred:!1})}):t});return r.setState({repositories:Object(h.a)({},r.state.repositories,{edges:n})})}).catch(function(e){r.setState({errors:e}),r.context.unSetFetchingToFalse()})},r.state={user:"majiyd",searchingUser:null,url:null,errors:null,repositories:[],cursors:[]},r.starRepository=r.starRepository.bind(Object(m.a)(r)),r}return Object(s.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e=this.state,t=e.user,r=e.url,n=e.errors,a=e.repositories;return this.props.token?u.a.createElement("div",{className:y.a.app},u.a.createElement("h1",null,"Github Client"),u.a.createElement("form",{onSubmit:this.onSubmit,className:y.a.form},u.a.createElement("div",null,u.a.createElement("label",{htmlFor:"github-user"},"Get all repos by:"),u.a.createElement("input",{id:"github-user",type:"text",onChange:this.onChange,className:y.a.input,value:t})),u.a.createElement(w,{type:"submit",text:"Submit"})),u.a.createElement("hr",{style:{border:"1px solid rgba(0, 0, 0, 0.1)",marginBottom:"4%"}}),u.a.createElement(T,{name:t,url:r,repositories:a,errors:n,onFetchMoreRepositories:this.fetchMoreRepositories,onFetchPreviousRepositories:this.fetchPreviousRepositories,starRepository:this.starRepository,unStarRepository:this.unStarRepository})):u.a.createElement(N,null)}}]),t}(u.a.Component);G.contextType=j,G.contextType=j;var H=G,$=function(e){function t(e){var r;return Object(n.a)(this,t),(r=Object(o.a)(this,Object(i.a)(t).call(this,e))).state={token:null,isFetching:!1},r}return Object(s.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement("div",null,this.state.isFetching?u.a.createElement("h3",{style:{textAlign:"center",position:"fixed",color:"#E10098",width:"100%",zIndex:"3",textShadow:"0 1px 2px rgba(255, 0, 152,.1)"}},"Loading..."):"",u.a.createElement(C,{value:{state:this.state,setFetchingToTrue:function(){e.setState({isFetching:!0})},unSetFetchingToFalse:function(){e.setState({isFetching:!1})},setToken:function(t){e.setState({token:t})}}},u.a.createElement(H,{token:this.state.token})))}}]),t}(u.a.Component);p.a.render(u.a.createElement($,null),document.getElementById("root"))}},[[26,1,2]]]);
//# sourceMappingURL=main.b9648ce1.chunk.js.map